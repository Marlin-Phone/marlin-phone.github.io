---
layout: post
mathjax: true
title: "异或运算的骚操作"
subtitle: '异或'
date: 2025-05-02 19:14:00
author: "Marlin"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
  - 异或
  - 位运算
  - 二进制
---

## 异或运算的骚操作
### 问题描述

先来个好玩的问题：  
袋子里有 \( a \) 个白球、\( b \) 个黑球。每次从袋子里拿出 2 个球，每个球被拿出的概率均等。如果拿出的是 2 个白球或 2 个黑球，那么就往袋子里重新放入 1 个白球；如果拿出的是 1 个白球和 1 个黑球，那么就往袋子里重新放入 1 个黑球。  
那么最终袋子里一定会只剩 1 个球，请问最终的球是黑球的概率是多少？用 \( a \) 和 \( b \) 表达这个概率。

### 答案

**黑球的数量如果是偶数，最终是黑球的概率是 \( 0\% \)。**  
**黑球的数量如果是奇数，最终是黑球的概率是 \( 100\% \)。**  
**完全和白球的数量无关。**

---

### 异或运算性质

1. **异或运算就是无进位相加**；  
2. **异或运算满足交换律、结合律，也就是同一批数字，不管异或顺序是什么，最终的结果都是一个**  
3. **0⊕n=n，n⊕n=0**  
4. **整体异或和如果是x，整体中某个部分的异或如果是y，那么剩下部分的异或和是x⊕y**

这些结论最重要的就是 1)，所有其他结论都可以由这个结论推导得到。

其中第 4) 相关的题目最多，利用区间上异或和的性质。

Nim 博弈也是和异或运算相关的算法。

---

### 题目分析

由于  
取出两个白球，则放入一个白球;  
取出两个黑球，则放入一个白球;  
取出一个白球和一个黑球，则放入一个黑球。  
可以抽象为：
0⊕0=0;  
1⊕1=0;  
0⊕1=1。  
由此可以得到答案：  
最终的球是黑球的概率只与放入的黑球数量有关，黑球为偶数，则最终球是黑球的概率为 0%；黑球为奇数，则最终球是黑球的概率为 100%。

---

### 题目1 交换两个数
```cpp
// 记初始a为a1, b为b1
a = a ^ b; 
// a == a1 ^ b1

b = a ^ b; 
// b == (a1 ^ b1) ^ b1 == a1

a = a ^ b; 
// a == (a1 ^ b1) ^ ((a1 ^ b1) ^ b1) == b1
```
运行上段代码后，a，b的值互换了。

**注意: a与b必须要在两个内存地址上，否则会将a，b刷为0。**
```cpp
int nums[2] = {1, 2};
int a = nums[0], b = nums[1];
for(int i = 0; i < 2; i++){
    for(int j = 0; j < 2; j++){
        nums[i] = nums[i] ^ nums[j];
        nums[j] = nums[i] ^ nums[j];
        nums[i] = nums[i] ^ nums[j];
    }
}
```
ERROR: nums[0] = 0, nums[1] = 0  
因为当i == j 时，nums[i]被刷为0了。

---

### 题目2 返回两个数的最大值

